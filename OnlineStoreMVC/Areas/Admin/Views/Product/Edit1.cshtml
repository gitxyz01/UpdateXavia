@model OnlineStore.Model.ViewModel.ProductFullView
@{
    ViewBag.Title = "Edit1";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutTy.cshtml";
}

<script src="~/Content/ckeditor/ckeditor.js"></script>
<script src="~/Scripts/Admin/product-management.js"></script>
<div class="pcoded-inner-content">
    <div class="card">
        <div class="card-header">
            <div class="row">
                <div class="col-sm-6">
                    <h5>Cập Nhật Sản Phẩm</h5>
                </div>
                <div class="col-sm-6" style="text-align:right;">
                    @Html.ActionLink("Danh Sách", "Index1", null, new { @class = "btn btn-grd-primary" })
                </div>
            </div>
        </div>
        <div class="card-block tab-icon">
            <!-- Row start -->
            <div class="row">
                <div class="col-lg-12 col-xl-12">
                    <!-- <h6 class="sub-title">Tab With Icon</h6> -->
                    <!-- Nav tabs -->
                    <ul class="nav nav-tabs md-tabs " role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" data-toggle="tab" href="#home7" role="tab"><i class="icofont icofont-home"></i>Thông Tin Cơ Bản</a>
                            <div class="slide"></div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#profile7" role="tab"><i class="icofont icofont-ui-user "></i>Hình Ảnh</a>
                            <div class="slide"></div>
                        </li>
                    </ul>
                    <!-- Tab panes -->
                    <div class="tab-content card-block">
                        <div class="tab-pane active" id="home7" role="tabpanel">
                            <div class="row">
                                <div>
                                    <div class="box-body">
                                        @using (Html.BeginForm("Edit", "Product", null, FormMethod.Post, new { enctype = "multipart/form-data" }))
                                        {
                                            <div class="form-horizontal">
                                                @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                                                @Html.HiddenFor(model => model.Id)
                                                <div class="form-group row">
                                                    @Html.LabelFor(model => model.ProductCode, htmlAttributes: new { @class = "control-label col-md-2" })
                                                    <div class="col-sm-9">
                                                        @Html.EditorFor(model => model.ProductCode, new { htmlAttributes = new { @class = "form-control" } })
                                                        @Html.ValidationMessageFor(model => model.ProductCode, "", new { @class = "text-danger" })
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    @Html.LabelFor(model => model.Name, htmlAttributes: new { @class = "control-label col-md-2" })
                                                    <div class="col-sm-9">
                                                        @Html.EditorFor(model => model.Name, new { htmlAttributes = new { @class = "form-control" } })
                                                        @Html.ValidationMessageFor(model => model.Name, "", new { @class = "text-danger" })
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    @Html.LabelFor(model => model.Price, htmlAttributes: new { @class = "control-label col-md-2" })
                                                    <div class="col-sm-9">
                                                        @Html.EditorFor(model => model.Price, new { htmlAttributes = new { @class = "form-control" } })
                                                        @Html.ValidationMessageFor(model => model.Price, "", new { @class = "text-danger" })
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    @Html.LabelFor(model => model.Quantity, htmlAttributes: new { @class = "control-label col-md-2" })
                                                    <div class="col-sm-9">
                                                        @Html.EditorFor(model => model.Quantity, new { htmlAttributes = new { @class = "form-control" } })
                                                        @Html.ValidationMessageFor(model => model.Quantity, "", new { @class = "text-danger" })
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    @Html.LabelFor(model => model.Unit, htmlAttributes: new { @class = "control-label col-md-2" })
                                                    <div class="col-sm-9">
                                                        @Html.EditorFor(model => model.Unit, new { htmlAttributes = new { @class = "form-control" } })
                                                        @Html.ValidationMessageFor(model => model.Unit, "", new { @class = "text-danger" })
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    @Html.LabelFor(model => model.BrandId, htmlAttributes: new { @class = "control-label col-md-2" })
                                                    <div class="col-sm-9">
                                                        @Html.DropDownList("BrandId", @ViewBag.BrandId as SelectList, "Chọn thương hiệu", new { @class = "form-control form-control-info" })
                                                        @Html.ValidationMessageFor(model => model.BrandId, "", new { @class = "text-danger" })
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    <label class="col-sm-2 col-form-label" for="Categories">
                                                        Danh Mục Sản Phẩm <span class="required"></span>
                                                    </label>
                                                    <div class="col-sm-9">
                                                        @Html.DropDownList("CategoryId", ViewBag.Categories as MultiSelectList, new { multiple = "multiple", @class = "multiDropdown form-control", data_placeholder = "Chọn danh mục" })
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    @Html.LabelFor(model => model.ProductGroups, htmlAttributes: new { @class = "control-label col-md-2" })
                                                    <div class="col-sm-9">
                                                        @Html.DropDownList("ProductGroupId", ViewBag.ProductGroups as MultiSelectList, new { multiple = "multiple", @class = "multiDropdown form-control", data_placeholder = "Chọn nhóm sản phẩm" })
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    @Html.LabelFor(model => model.Description, htmlAttributes: new { @class = "control-label col-md-2" })
                                                    <div class="col-sm-9">
                                                        @Html.EditorFor(model => model.Description, new { htmlAttributes = new { @class = "form-control" } })
                                                        @Html.ValidationMessageFor(model => model.Description, "", new { @class = "text-danger" })
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    @Html.LabelFor(model => model.Description2, htmlAttributes: new { @class = "control-label col-md-2" })
                                                    <div class="col-sm-9">
                                                        @Html.TextAreaFor(model => model.Description2, new { htmlAttributes = new { @class = "form-control" } })
                                                        @Html.ValidationMessageFor(model => model.Description2, "", new { @class = "text-danger" })
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    @Html.LabelFor(model => model.Tags, htmlAttributes: new { @class = "control-label col-md-2" })
                                                    <div class="col-sm-9">
                                                        @Html.EditorFor(model => model.Tags, new { htmlAttributes = new { @class = "form-control" } })
                                                        @Html.ValidationMessageFor(model => model.Tags, "", new { @class = "text-danger" })
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    @Html.LabelFor(model => model.IsNewProduct, htmlAttributes: new { @class = "control-label col-md-2" })
                                                    <div class="col-sm-9">
                                                        <div class="checkbox-fade fade-in-success col-sm-2">
                                                            <label>
                                                                @if (Model.IsNewProduct == true)
    {
                                                            <input type="checkbox" value="true" name="IsNewProduct" checked>
}
else
{
                                                            <input type="checkbox" value="true" name="IsNewProduct">
}
                                                                <span class="cr">
                                                                    <i class="cr-icon icofont icofont-ui-check txt-success"></i>
                                                                </span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    @Html.LabelFor(model => model.IsBestSellProduct, htmlAttributes: new { @class = "control-label col-md-2" })
                                                    <div class="col-sm-9">
                                                        <div class="checkbox-fade fade-in-success col-sm-2">
                                                            <label>
                                                                @if (Model.IsBestSellProduct == true)
                                                                {
                                                            <input type="checkbox" value="true" name="IsBestSellProduct" checked>
                                                                }
                                                                else
                                                                {
                                                            <input type="checkbox" value="true" name="IsBestSellProduct">
                                                                }
                                                            <span class="cr">
                                                                <i class="cr-icon icofont icofont-ui-check txt-success"></i>
                                                            </span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    @Html.LabelFor(model => model.SortOrder, htmlAttributes: new { @class = "control-label col-md-2" })
                                                    <div class="col-sm-9">
                                                        @Html.EditorFor(model => model.SortOrder, new { htmlAttributes = new { @class = "form-control" } })
                                                        @Html.ValidationMessageFor(model => model.SortOrder, "", new { @class = "text-danger" })
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    @Html.LabelFor(model => model.Status, htmlAttributes: new { @class = "control-label col-md-2" })
                                                    <div class="col-sm-9">
                                                        <select name="Status" class="form-control form-control-info">
                                                            <option value="1">Hoạt Động</option>
                                                            <option value="0">Khóa</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    <div class="col-md-offset-2 col-md-10">
                                                        <input type="submit" value="Cập nhật" class="btn btn-primary" />
                                                        @Html.ActionLink("Hủy", "Index1", null, new { @class = "btn btn-grd-inverse" })
                                                    </div>
                                                </div>
                                            </div>
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="profile7" role="tabpanel">
                            <div class="panel panel-info">
                                <div class="panel-heading bg-info">
                                    <h5 class="box-title">Danh mục hình ảnh sản phẩm</h5>
                                </div>
                                <div class="panel-body">

                                            <div class="box-body">
                                                <div id="EditProduct_ListProductImages">
                                                    <table class="table">
                                                        <tr>
                                                            <th>
                                                                Tên ảnh
                                                            </th>
                                                            <th>
                                                                Ảnh
                                                            </th>
                                                            <th>
                                                                Hiển thị
                                                            </th>
                                                            <th>
                                                                Ảnh đại diện
                                                            </th>
                                                            <th></th>
                                                        </tr>
                                                        @foreach (var item in Model.share_Images)
                        {
                                <tr data-id="@item.Id" class="display-mode">
                                    <td>
                                        @item.ImageName
                                    </td>
                                    <td>
                                        <img src="@item.ImagePath" height="70" width="70" alt="ảnh không tồn tại" />
                                    </td>
                                    <td>
                                        @if (item.IsActive)
        {
                                <span>Hiện</span>
}
else
{
                                <span>Ẩn</span>
}
                                    </td>
                                    <td>
                                        @if (Model.CoverImageId == item.Id)
        {
                                        <i class="icofont icofont-checked"></i>
}
else
{
                                        <i class="icofont icofont-close"></i>
}
                                    </td>
                                    <td>
                                        <input type="button" id="EditProductImage" onclick="ProductManagement.editProductImage(this,@item.Id)" value="Sửa" class="btn btn-primary">
                                        <input type="button" id="DeleteProductImage" onclick="ProductManagement.requestDeleteProductImage(@Model.Id,@item.Id)" value="Xóa" class="btn btn-danger">
                                    </td>
                                </tr>
                                <tr data-id="@item.Id" class="edit-mode d-none">
                                    <td>
                                        @Html.EditorFor(modelItem => item.ImageName, new { htmlAttributes = new { @class = "txt-imagename" } })
                                    </td>
                                    <td>
                                        <img src="@item.ImagePath" height="70" width="70" alt="ảnh không tồn tại" />
                                    </td>
                                    <td>
                                        @Html.EditorFor(modelItem => item.IsActive, new { htmlAttributes = new { @class = "ckb-isactive" } })
                                    </td>
                                    <td>
                                        @if (Model.CoverImageId == item.Id)
        {
                                <input type="checkbox" class="ckb-iscoverimage" checked />
}
else
{
                                <input type="checkbox" class="ckb-iscoverimage" />
}
                                    </td>
                                    <td>
                                        <input type="button" id="UpdateProductImage" onclick="ProductManagement.updateProductImage(this,@Model.Id,@item.Id)" value="Cập nhật" class="btn btn-primary">
                                        <input type="button" id="CancelUpdateProductImage" onclick="ProductManagement.cancelUpdateProductImage(this,@item.Id)" value="Hủy" class="btn btn-danger">
                                    </td>
                                </tr>
}
                                                    </table>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-md-offset-2 col-md-10" id="ProductEdit_UploadPartialView">
                                                        <div class="row">
                                                            <div class="col-md-12">
                                                                @if (ViewBag.Error != null)
                                {
                                    <h4 style="color:red">@ViewBag.Error</h4>
}
                                                                @using (Ajax.BeginForm("UploadImage", "Product", new AjaxOptions() { UpdateTargetId = "EditProduct_ListProductImages", HttpMethod = "POST", OnSuccess = "kaka2" }, new { enctype = "multipart/form-data" }))
                                {
                                    @Html.AntiForgeryToken()
                                    <input type="file" name="files" class="btn btn-info" style="display:inline-block;margin-right:10px;">
                                    <input type="hidden" value=@Model.Id name="productId" />
                                    <input type="submit" value="upload" class="btn btn-success" style="display:inline-block;width:100px;" />
}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                      
                        </div>

                    </div>
                </div>

            </div>
            <!-- Row end -->
        </div>


@section scripts{
    <script>
    $(document).ready(function () {
        ProductManagement.init();
    });
    function kaka2() {
        alert("kaka");
    }
    </script>
    <script>
    $(document).ready(function () {
        // CKEditor
        CKEDITOR.replace('Description2');
    })
    $(document).ready(function () {
        $(".multiDropdown").select2({
        });
    });
    </script>

}

